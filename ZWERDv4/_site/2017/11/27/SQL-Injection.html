<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta itemprop="name"            content="Zwerd.com">
  <meta itemprop="description"     content="A stunning blog of freaking PT warrior; you will find here cool stuff about networks, security and massive attacks!">
  <meta itemprop="image"           content="https://zwerd.com/favicon.gif">
  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1" />

  <title>
    
      SQL Injection &middot; Guy Zwerdling
    
  </title>

  


  <!-- CSS -->
  <link rel="stylesheet" href="/assets/css/main.css" />
  

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abril+Fatface" />

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="./favicon.gif" />
<link rel="shortcut icon" href="./favicon.ico" />


  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml" />

  <!-- Additional head bits without overriding original head -->
</head>


  <body class="post">

    <div id="sidebar">
  <div class="sidebar-mugshot">
      <img src="/assets/images/logo.gif" alt="Guy Zwerdling">
  </div>
  <header>
    <div class="site-title">
      <a href="/">
        
          <span class="back-arrow icon"><svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
  <path d="M0 0h24v24H0z" fill="none"/>
  <path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/>
</svg></span>
        
        Guy Zwerdling
      </a>
    </div>
    <p class="lead">A stunning blog of freaking PT warrior</p>
  </header>
  <nav id="sidebar-nav-links">
  
    <a class="home-link "
        href="/">Home</a>
  
  

  

  


  
    
  

  
    
      <a class="page-link "
          href="/Applications.html">Applications</a>
    
  

  
    
      <a class="page-link "
          href="/CV.html">CV</a>
    
  

  
    
      <a class="page-link "
          href="/about.html">About</a>
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  


  


  
    
  

  
    
  

  
    
  

  
    
  

  
    
  

  

  
    
  

  
    
  

  

  
    
  


  <!-- Optional additional links to insert in sidebar nav -->
</nav>


  

  <nav id="sidebar-icon-links">
  
    <a id="github-link"
       class="icon" title="Github Project" aria-label="Github Project"
       href="https://github.com/zwerd">
      <?xml version="1.0"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536;" xml:space="preserve" class=""><g><g>
	<g>
		<path d="M158.173,352.599c-3.049,0.568-4.381,1.999-3.999,4.281c0.38,2.283,2.093,3.046,5.138,2.283    c3.049-0.76,4.38-2.095,3.997-3.997C162.931,353.074,161.218,352.216,158.173,352.599z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M141.898,354.885c-3.046,0-4.568,1.041-4.568,3.139c0,2.474,1.619,3.518,4.853,3.138c3.046,0,4.57-1.047,4.57-3.138    C146.753,355.553,145.134,354.502,141.898,354.885z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M119.629,354.022c-0.76,2.095,0.478,3.519,3.711,4.284c2.855,1.137,4.664,0.568,5.424-1.714    c0.572-2.091-0.666-3.61-3.711-4.568C122.197,351.265,120.39,351.922,119.629,354.022z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M414.41,24.123C398.326,8.042,378.964,0,356.309,0H82.225C59.577,0,40.208,8.042,24.123,24.123    C8.042,40.207,0,59.576,0,82.225v274.088c0,22.65,8.042,42.017,24.123,58.098c16.084,16.084,35.454,24.126,58.102,24.126h63.953    c4.184,0,7.327-0.144,9.42-0.424c2.092-0.288,4.184-1.526,6.279-3.717c2.096-2.187,3.14-5.376,3.14-9.562    c0-0.568-0.05-7.046-0.144-19.417c-0.097-12.375-0.144-22.176-0.144-29.41l-6.567,1.143c-4.187,0.76-9.469,1.095-15.846,0.999    c-6.374-0.096-12.99-0.76-19.841-1.998c-6.855-1.239-13.229-4.093-19.13-8.562c-5.898-4.477-10.085-10.328-12.56-17.559    l-2.856-6.571c-1.903-4.373-4.899-9.229-8.992-14.554c-4.093-5.332-8.232-8.949-12.419-10.852l-1.999-1.428    c-1.331-0.951-2.568-2.098-3.711-3.429c-1.141-1.335-1.997-2.669-2.568-3.997c-0.571-1.335-0.097-2.43,1.427-3.289    c1.524-0.855,4.281-1.279,8.28-1.279l5.708,0.855c3.808,0.76,8.516,3.042,14.134,6.851c5.614,3.806,10.229,8.754,13.846,14.843    c4.38,7.806,9.657,13.75,15.846,17.843c6.184,4.097,12.419,6.143,18.699,6.143s11.704-0.476,16.274-1.424    c4.565-0.954,8.848-2.385,12.847-4.288c1.713-12.751,6.377-22.559,13.988-29.41c-10.848-1.143-20.602-2.854-29.265-5.14    c-8.658-2.286-17.605-5.995-26.835-11.136c-9.234-5.14-16.894-11.512-22.985-19.13c-6.09-7.618-11.088-17.61-14.987-29.978    c-3.901-12.375-5.852-26.652-5.852-42.829c0-23.029,7.521-42.637,22.557-58.814c-7.044-17.32-6.379-36.732,1.997-58.242    c5.52-1.714,13.706-0.428,24.554,3.855c10.85,4.286,18.794,7.951,23.84,10.992c5.046,3.042,9.089,5.614,12.135,7.71    c17.705-4.949,35.976-7.423,54.818-7.423c18.841,0,37.115,2.474,54.821,7.423l10.849-6.852c7.426-4.57,16.18-8.757,26.269-12.562    c10.088-3.806,17.795-4.854,23.127-3.14c8.562,21.51,9.328,40.922,2.279,58.241c15.036,16.179,22.559,35.786,22.559,58.815    c0,16.18-1.951,30.505-5.852,42.969c-3.898,12.467-8.939,22.463-15.13,29.981c-6.184,7.519-13.894,13.843-23.124,18.986    c-9.232,5.137-18.178,8.853-26.84,11.132c-8.661,2.286-18.414,4.004-29.263,5.147c9.891,8.562,14.839,22.072,14.839,40.538v68.238    c0,3.237,0.472,5.852,1.424,7.851c0.958,1.998,2.478,3.374,4.571,4.141c2.102,0.76,3.949,1.235,5.571,1.424    c1.622,0.191,3.949,0.287,6.995,0.287h63.953c22.648,0,42.018-8.042,58.095-24.126c16.084-16.084,24.126-35.454,24.126-58.102    V82.225C438.533,59.576,430.491,40.204,414.41,24.123z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M86.793,319.195c-1.331,0.948-1.141,2.471,0.572,4.565c1.906,1.902,3.427,2.189,4.57,0.855    c1.331-0.948,1.141-2.471-0.575-4.569C89.458,318.336,87.936,318.049,86.793,319.195z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M77.374,312.057c-0.57,1.335,0.096,2.478,1.999,3.426c1.521,0.955,2.762,0.767,3.711-0.568    c0.57-1.335-0.096-2.478-1.999-3.433C79.182,310.91,77.945,311.102,77.374,312.057z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M95.646,330.331c-1.715,0.948-1.715,2.666,0,5.137c1.713,2.478,3.328,3.142,4.853,1.998c1.714-1.334,1.714-3.142,0-5.427    C98.978,329.571,97.359,328.993,95.646,330.331z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		<path d="M105.641,343.174c-1.714,1.526-1.336,3.327,1.142,5.428c2.281,2.279,4.185,2.566,5.708,0.849    c1.524-1.519,1.143-3.326-1.142-5.42C109.068,341.751,107.164,341.463,105.641,343.174z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
	</g>
</g></g> </svg>

    </a>
    <a id="twitter"
       class="icon" title="twitter" aria-label="Guy twitter"
       href="https://twitter.com/guyzwerdling">
      <?xml version="1.0"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" viewBox="0 0 486.392 486.392" style="enable-background:new 0 0 486.392 486.392;" xml:space="preserve" width="512px" height="512px" class=""><g><g>
	<g>
		<g>
			<path d="M395.193,0H91.198C40.826,0,0,40.826,0,91.198v303.995c0,50.372,40.826,91.198,91.198,91.198     h303.995c50.372,0,91.198-40.827,91.198-91.198V91.198C486.392,40.826,445.565,0,395.193,0z M364.186,188.598l0.182,7.752     c0,79.16-60.221,170.359-170.359,170.359c-33.804,0-65.268-9.91-91.776-26.904c4.682,0.547,9.454,0.851,14.288,0.851     c28.059,0,53.868-9.576,74.357-25.627c-26.204-0.486-48.305-17.814-55.935-41.586c3.678,0.669,7.387,1.034,11.278,1.034     c5.472,0,10.761-0.699,15.777-2.067c-27.39-5.533-48.031-29.7-48.031-58.701v-0.76c8.086,4.499,17.297,7.174,27.116,7.509     c-16.051-10.731-26.63-29.062-26.63-49.825c0-10.974,2.949-21.249,8.086-30.095c29.518,36.236,73.658,60.069,123.422,62.562     c-1.034-4.378-1.55-8.968-1.55-13.649c0-33.044,26.812-59.857,59.887-59.857c17.206,0,32.771,7.265,43.714,18.908     c13.619-2.706,26.448-7.691,38.03-14.531c-4.469,13.984-13.953,25.718-26.326,33.135c12.069-1.429,23.651-4.682,34.382-9.424     C386.073,169.659,375.889,180.208,364.186,188.598z" data-original="#010002" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
		</g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
	<g>
	</g>
</g></g> </svg>

    </a>
    <a id="linkedin"
       class="icon" title="linkedin" aria-label="Guy linkedin"
       href="https://www.linkedin.com/in/guy-zwerdling/">
      <?xml version="1.0"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="Capa_1" x="0px" y="0px" width="512px" height="512px" viewBox="0 0 438.536 438.536" style="enable-background:new 0 0 438.536 438.536;" xml:space="preserve"><g><g>
	<path d="M414.41,24.123C398.333,8.042,378.963,0,356.315,0H82.228C59.58,0,40.21,8.042,24.126,24.123   C8.045,40.207,0.003,59.576,0.003,82.225v274.084c0,22.647,8.042,42.018,24.123,58.102c16.084,16.084,35.454,24.126,58.102,24.126   h274.084c22.648,0,42.018-8.042,58.095-24.126c16.084-16.084,24.126-35.454,24.126-58.102V82.225   C438.532,59.576,430.49,40.204,414.41,24.123z M133.618,367.157H67.666V169.016h65.952V367.157z M127.626,132.332   c-6.851,6.567-15.893,9.851-27.124,9.851h-0.288c-10.848,0-19.648-3.284-26.407-9.851c-6.76-6.567-10.138-14.703-10.138-24.41   c0-9.897,3.476-18.083,10.421-24.556c6.95-6.471,15.942-9.708,26.98-9.708c11.039,0,19.89,3.237,26.553,9.708   c6.661,6.473,10.088,14.659,10.277,24.556C137.899,117.625,134.477,125.761,127.626,132.332z M370.873,367.157h-65.952v-105.92   c0-29.879-11.036-44.823-33.116-44.823c-8.374,0-15.42,2.331-21.128,6.995c-5.715,4.661-9.996,10.324-12.847,16.991   c-1.335,3.422-1.999,8.75-1.999,15.981v110.775h-65.952c0.571-119.529,0.571-185.579,0-198.142h65.952v27.974   c13.867-21.681,33.558-32.544,59.101-32.544c22.84,0,41.21,7.52,55.104,22.554c13.895,15.037,20.841,37.214,20.841,66.519v113.64   H370.873z" data-original="#000000" class="active-path" data-old_color="#ffffff" fill="#ffffff"/>
</g></g> </svg>

    </a>
    <a id="github-download-link"
       class="icon" title="Downloads" aria-label="Downloads"
       href="/Downloads/">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <a id="subscribe-link"
     class="icon" title="Subscribe" aria-label="Subscribe"
     href="/feed.xml">
    <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <circle cx="6.18" cy="17.82" r="2.18"/>
    <path d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"/>
</svg>
  </a>

  
  
  
  

  
    <a id="tags-link"
       class="icon"
       title="Tags" aria-label="Tags"
       href="/tags.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
    </a>
  

  
    <a id="search-link"
       class="icon"
       title="Search" aria-label="Search"
       href="/search.html">
      <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
    <path d="M0 0h24v24H0z" fill="none"/>
</svg>
    </a>
  

  <!-- Optional additional links to insert for icons links -->
</nav>

  <p>
  &copy; 2017.
  <a href="/LICENSE.md">Zwerd Web Deisgn</a>
</p>

</div>


    <main class="container">
      <header>
  <h1 class="post-title">SQL Injection</h1>
</header>
<div class="content">
  <div class="post-meta">
  <span class="post-date">27 Nov 2017</span>
  <span class="post-categories">
    
  </span>
</div>

  <div class="post-body">
    <p>SQL or Structured Query Language is a way to store and pullout data from database and it’s fairly easy because it’s like English actually, you can write things like <code class="highlighter-rouge">SELECT * FROM thistable</code> and every such command will bring up to you results from the database and this was the way to store things in websites and still does for many years.</p>

<p>If we talking about injection you may know that inject some code is not related only to SQL, you can actually to do so with various programing language of course it depend on how the programmer developed that site, but if he or she not care enough about the little things in that code, we may find some way to inject some unwanted code to the website.</p>

<p>In that  article I would like to present and demonstrate the following in order for you have a full picture of what is going on here, so the main goal here is:</p>
<ul>
  <li><a href="#how-sql-work">How SQL work.</a></li>
  <li><a href="#what-is-the-vulnerability">What is the vulnerability.</a></li>
  <li><a href="#exploit-that-vulnerability">Exploit that vulnerability.</a></li>
  <li><a href="#how-to-migrate-that-vulnerability">How to migrate that vulnerability.</a></li>
</ul>

<h3 id="how-sql-work">How SQL work</h3>

<p>I think that before you five in to SQL you need basic understanding how it works, in this section I’m using Ubuntu server with mysql database, so first of all let’s connect to our SQL database.</p>

<p>To setup mysql in you Ubuntu server you can follow <a href="https://help.ubuntu.com/lts/serverguide/mysql.html">this documentation</a> or you can just type:<br /></p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code> sudo apt update
 sudo apt upgrade
 sudo apt install mysql-server
 sudo service mysql start
 sudo service mysql status
</code></pre></div></div>

<p>The last command will show you what is the status of your sql service, if you have some issue related to that service please search the error you got in <a href="stackoverflow.com">stackoverflow</a> it is a grate way to solve issues with the community.</p>

<p><img src="/assets/images/sql-injection-001.png" alt="sql-injection-001.png" />
 <strong>Figure 1</strong> MySQL server.</p>

<p>After your sql server are ready to use just connect to the database, if it is you first time you should get aome alert about setup your password, just do the command <code class="highlighter-rouge">sudo mysql -u root -p</code></p>

<p><img src="/assets/images/sql-injection-002.png" alt="sql-injection-002.png" />
 <strong>Figure 2</strong> Connect to the database.</p>

<p>Now let’s look on the command we have in SQL.<br /></p>
<ul>
  <li><code class="highlighter-rouge">CREATE DATABASE database_name;</code> - create some database, in that database we will create tables that contain values of our users.<br /></li>
  <li><code class="highlighter-rouge">CREATE TABLE table_name;</code> - creating a table with columns and datatype.<br /></li>
  <li><code class="highlighter-rouge">DROP  DATABASE database_name;</code> - delete the database.<br /></li>
  <li><code class="highlighter-rouge">DELETE FROM table_name WHERE column_name=value;</code> - delete some value in our table base on the column_name name, please notice the <code class="highlighter-rouge">WHERE</code> statement, if you doesn’t specified that WHERE it will delete every value in the table.<br /></li>
  <li><code class="highlighter-rouge">ALERT TABLE table_name DROP COLUMN column_name;</code> - this command will delete the column in the table that we specified.<br /></li>
  <li><code class="highlighter-rouge">SELECT * FROM table_name;</code> - this command will display every value from the table.<br /></li>
  <li><code class="highlighter-rouge">SELECT * FROM table_name ORDER BY column_name [ASC/DESC];</code> - this will display the data ordered by the method we chose, DESC stand for descending and ASC stand for ascending.<br /></li>
  <li><code class="highlighter-rouge">ALTER TABLE table_name ADD column_name datatype;</code> - to add some column to out table.<br /></li>
  <li><code class="highlighter-rouge">UPDATE table_name SET column_name = value WHERE column_name = value;</code> - set some value to some filed base on column_name value.<br /></li>
</ul>

<p>SQL Operators:<br /></p>

<table>
  <thead>
    <tr>
      <th>Operator</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">=</code></td>
      <td style="text-align: left">Equal to</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;&gt;</code></td>
      <td style="text-align: left">not equal to ( is the same as !=)</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&gt;</code></td>
      <td style="text-align: left">Greater than</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">&lt;</code></td>
      <td style="text-align: left">Less than</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">#</code></td>
      <td style="text-align: left">Used for comment</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">%</code></td>
      <td style="text-align: left">If we use <code class="highlighter-rouge">LIKE</code> it is used as wildcard character</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">BETWEEN</code></td>
      <td style="text-align: left">will give us a rang</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">LIKE</code></td>
      <td style="text-align: left">matches a pattern</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">IS or IS NOT</code></td>
      <td style="text-align: left">compare to null</td>
    </tr>
  </tbody>
</table>

<p><strong>Table 1</strong> for more operator refer to <a href="https://www.w3schools.com/sql/sql_operators.asp">that link.</a></p>

<p>Let’s create new database with table and filled that table with users ID and data.<br /></p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">CREATE DATABASE mysite;
USE mysite;</code></pre></figure>

<p>Please remember that you mush chose database before you create some table.</p>

<p><img src="/assets/images/sql-injection-003.png" alt="sql-injection-003.png" />
<strong>Figure 3</strong> Select database.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">CREATE TABLE users(
  id INT NOT NULL,
  nickName VARCHAR(255),
  firstName VARCHAR(255),
  lestName VARCHAR(255),
  email VARCHAR(255)
  );</code></pre></figure>

<p><img src="/assets/images/sql-injection-004.png" alt="sql-injection-004.png" />
<strong>Figure 4</strong> Create table.</p>

<p>So far we created database named “mysite” and add table named users, in that table we have users ID which is must be valuable (NOT NULL) and number (INT which is an integer), in the other values we specified that each value can be long up to 255 characters (VARCHAR(255)), now we need to filled that table up.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">INSERT INTO users(id, nickName, firstName, lestName, email) VALUES
(1, 'Jimi', 'Johnny', 'Hendrix', 'jhendrix@gmail.com'),
(2, 'Jenni', 'Jennifer', 'Batten', 'jbatten@gmail.com'),
(3, 'Steve', 'Steven', 'Vai', 'svai@gmail.com'),
(4, 'Jim', 'James', 'Morrison', 'jmorrison@gmail.com'),
(5, 'AliceCooper', 'Vincent', 'Furnier', 'vfurnier@gmail.com');</code></pre></figure>

<p><img src="/assets/images/sql-injection-005.png" alt="sql-injection-005.png" />
<strong>Figure 5</strong> Filled up the tables with values.</p>

<p>To display the all table, just type SELECT and asterisk FROM the table name.
<img src="/assets/images/sql-injection-006.png" alt="sql-injection-006.png" />
<strong>Figure 6</strong> Tables with values.</p>

<p>Note that we can insert more that one command in the same raw.
<img src="/assets/images/sql-injection-007.png" alt="sql-injection-007.png" />
<strong>Figure 7</strong> More than one command.</p>

<p>Now let’s change some email in out table, just type as follow:
<img src="/assets/images/sql-injection-008.png" alt="sql-injection-008.png" />
<strong>Figure 8</strong> Chenge email.</p>

<p>So if in some website used SQL to store some data in tables from the user, if some user change his email address, this is what actually append behind the scene.</p>

<p>We can also use some sentence that specified True of False to display something, in the next example I’m use 1=1 which mean True, this is why it display to me all of the values.
<img src="/assets/images/sql-injection-009.png" alt="sql-injection-009.png" />
<strong>Figure 9</strong> 1=1 is actually True.</p>

<p>We have a way to use wildcard like the next example:<br />
<code class="highlighter-rouge">SELECT * FROM users WHERE lastName LIKE '%n';</code>
In that case the query give up the last names that end with <code class="highlighter-rouge">n</code> which can be helpful to filter stuff.</p>

<p><img src="/assets/images/sql-injection-010.png" alt="sql-injection-010.png" />
<strong>Figure 10</strong> 1=1 is actually True.</p>

<h3 id="what-is-the-vulnerability">What is the vulnerability</h3>

<p>So in SQL the way it’s works with website is as follow,  let’s assume that we have some filed that ask us username and password, if we type in some value like <code class="highlighter-rouge">guy</code> and hit enter it will generate some command in SQL to the database like  <code class="highlighter-rouge">SELECT * FROM users WHERE USERNAME = 'guy';</code>, please note the quotation marks, in this way the database will bring back <code class="highlighter-rouge">"guy"</code>, the problem is with those quotation marks, it little bit tricky because let’s say that the user actually put in that filed quotation marks, something that look like that:
<code class="highlighter-rouge">SELECT * FROM users WHERE USERNAME = 'guy''</code></p>

<p>In that case it will failed because the command is not match up, and it will send some error, so it may be annoying, but if we think about that we can do some serious damage in that way because in SQL we have more command like <code class="highlighter-rouge">INSERT</code> to insert stuff or <code class="highlighter-rouge">UPDATE</code> to change stuff and <code class="highlighter-rouge">DELETE</code> to remove data from the database, so if we write on the username filed something more like:
 <code class="highlighter-rouge">guy"; DELETE * FROM table_name;</code></p>

<p>The command will work and because it is a SQL it will delete everything that in the table_name.</p>

<p>The way to migrate this issue is called escaping and it’s something like the programmer will setup in the code that every time we have quotation marks just put backslash before it, in that way the quotation marks in the filed will be handled as a character and not as quotation marks in the SQL so it may help to migrate the problem with command in SQL in the user input.</p>

<p>For that article I’m going to use DVWA which is great way to learn about vulnerability related to websites, the usual Linux Kali will be used to attack those websites and I hope you will enjoy it.
You can download DVWA from <a href="http://www.dvwa.co.uk/">here</a>, in this web you can find the source code which contain the REDAME.md file that can help you to install the DVWA on your operation system. We going to look on only the SQL injection in that article, I hope you enjoy it! I sure that I will!:]</p>

<p>There is a three type of SQL injection:</p>
<ul>
  <li>Error: we make some query to the database and we get some error from it, we can extract information about the server in that way.</li>
  <li>Union: in that case we use more then one SELECT SQL query in the same statements and get some single result.</li>
  <li>blind: in that type of SQL injection we can do more than ask the database true of false question and using whether valid page returned or not, or we can use the time it took for the page to load, we will see how that going on in that article.</li>
</ul>

<h3 id="exploit-that-vulnerability">Exploit that vulnerability.</h3>

<p>Ok guys, I have done to setup my Ubuntu server with php7.0 and mysql database and the website (DVWA) is live and running. I have Kali Linux machine and from that machine we going to do the coolest stuff!
So my topology look something like that:</p>

<p><img src="/assets/images/sql-injection-011.png" alt="sql-injection-011.png" />
<strong>Figure 11</strong> Topology for our lab.</p>

<p>you can do the same I did if you like, if you have some trouble in the installation process please feel free to leave a comment here or send me an email and I’ll be glad to help.</p>

<p>for this kind for lab you actually doesn’t need to setup spacial server just for DVWA, you can setup is on you computer and trying to attack from your Kali, or you can attack the website from your computer, it’s really doesn’t matter, you can also setup the web directly on your Kali which is the best I think.</p>

<p>Ok, let’s look on the DVWA website, we going to do every challenge in that web that related to SQL, so let’s start from the low level security to high, if you configure everything correctly you should get the following page:
<img src="/assets/images/sql-injection-012.png" alt="sql-injection-012.png" />
<strong>Figure 12</strong> Topology for our lab.</p>

<p>The default username is admin and password is password, after you login go to DVWA security tab and select low level and submit it.
<img src="/assets/images/sql-injection-013.png" alt="sql-injection-013.png" />
<strong>Figure 13</strong> Topology for our lab.</p>

<p>After that go SQL injection tab, and here we going to do our magic!
As you can see the User ID box and submit button, you can trying to insert some value in that box but nothing will happened, only the URL will be change but it’s irrelevant in that point. however if you type sum number in range of 1 to 5 you get some value from the database.</p>

<p><img src="/assets/images/sql-injection-014.png" alt="sql-injection-014.png" />
<strong>Figure 14</strong> Data from the database.</p>

<p>So we can see the users and their surenames, let’s play with the box little more, just write a comma <code class="highlighter-rouge">'</code> sign and click on the submit button it will bring up an error.
<img src="/assets/images/sql-injection-015.png" alt="sql-injection-015.png" />
<strong>Figure 15</strong> Data from the database.</p>

<p>So right now we know that the web server is vulnerable for Error base attack, so let’s try to play with it more. every query are generate some sentence with quotation marks on the value that the user type, so, in the case we typed 1 in the SQL query it would be something like <code class="highlighter-rouge">SELECT column FROM table WHERE number='1'</code>, remember we type only 1 without quotation marks, so when we type <code class="highlighter-rouge">1'</code> it actually look like <code class="highlighter-rouge">number= '1''</code>, so if we trying to put some query we can put in the filed something like that:<br />
<code class="highlighter-rouge">1' or '0'='0</code> <br />
In that case the query will look something like that:<br />
<code class="highlighter-rouge">number = '1' or '0'='0'</code><br />
In the query case it’s put quotation marks,I’ll bold it so you can see:<br />
number = <strong>‘</strong> 1’ or ‘0’=’0 <strong>‘</strong><br />
In that case it look like we add another values to the SQL query and the 0=0 is sort of True query, so the answer we get will be all the values because the existing of the value is true, let’s look how is works in the SQL, if we type that query we get the following:</p>

<p><img src="/assets/images/sql-injection-016.png" alt="sql-injection-016.png" />
<strong>Figure 16</strong> SQL query.</p>

<p>Now we extract all users from database because the True statement, every value is True so this is why we get every value from the table.</p>

<p>We can adding UNION to sql statement which mean that we use 2 SELECTED statement at once, so, we can write a brand new command in the input box and maybe the SQL will treat that statement as usual, please remember that if we use UNIUN, we can only use that in SELECT statement, and the SELECT statement must be query of equal column, as example the following:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">SELECT firstName, lastName, email LIKE '%te%' FROM users UNION SELECT firstName, lastName, email LIKE '%r%' FROM users;</code></pre></figure>

<p>In this statement we query the firstName and lastName from our mysite table and we display also the  who have email that contain ‘te’ in it, in the union we do the same but this time the query should display the rows from our table that contain ‘r’ in the email filed.</p>

<p><img src="/assets/images/sql-injection-017.png" alt="sql-injection-017.png" />
<strong>Figure 17</strong> SQL query with UNION.</p>

<p>Please note that we have a third column that contain <code class="highlighter-rouge">0</code> or <code class="highlighter-rouge">1</code>, which specified answer to our query. So if we go back to our Kali machine we can use UNION to display two SELECT at once, just inject the follow:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1' union select first_name,last_name from users WHERE user_id='2
</code></pre></div></div>

<p>And this is the SQL answer we get for that query:
<img src="/assets/images/sql-injection-018.png" alt="sql-injection-018.png" />
<strong>Figure 18</strong> SQL query with UNION display two users.</p>

<p>Please note that I used <code class="highlighter-rouge">first_name</code> and <code class="highlighter-rouge">last_name</code> for my query, you may ask how did I now that the column names are like that? if you check that website you will see the View Source button and if you click on that you will see the php code that contain the query with <code class="highlighter-rouge">first_name</code> and <code class="highlighter-rouge">last_name</code>, but please remember that in the real world it doesn’t likely you can view some php code of some site, normally the php code used as server side so you never been access to that code directly, you may try to extract that code with XSS or CSRF or any sort of attacks, but in some cases you may guess the query, just remember that the developer may used some common names, so it may be more simple to guess that column names than extract the code that contain the query.</p>

<p><img src="/assets/images/sql-injection-019.png" alt="sql-injection-019.png" />
<strong>Figure 19</strong> Source code.</p>

<p>I want you to new that there is more data that we can find about the database it self and it inportent to know that stuff so just follow me, you can make a SELECT query from the database for find boxes from the table without any value, so let’s say that in our table there is some box without value, we can may query to find this boxes as follow:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">SELECT first_name FROM users WHERE the middle_name IS NULL;</code></pre></figure>

<p>In that case that query bring us any user that he have no middle name, so that is the main used for NULL, there is another way to use it, but before that there is more things you should know, there is a way to query some data about the database it self, there is some  <a href="https://www.w3schools.com/sql/sql_ref_mysql.asp">functions</a> that used for check some values related to the database itself or mysql server we working on, as example what is the user we used for mysql, what is the version of mysql database, what is the name of the database we working on it and so on.</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">USE mysite;
SELECT database();</code></pre></figure>

<p>In that case the database will show us his name after we chose the database, in my case the database name will be ‘mysite’.</p>

<p><img src="/assets/images/sql-injection-024.png" alt="sql-injection-024.png" />
<strong>Figure 24</strong> Database function.</p>

<p>So let’s think carefully, we have a way to extract data about the database, but if we use injection with <code class="highlighter-rouge">UNION</code> we must use in our case two SELECT query because the original query that the php code produces include two column, so if we do something like:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">select
  first_name,
  last_name
  FROM users WHERE user_id='1' or '0'='0'
  UNION
  SELECT database();</code></pre></figure>

<p>we will get an error.</p>

<p><img src="/assets/images/sql-injection-025.png" alt="sql-injection-025.png" />
<strong>Figure 25</strong> Erorr “different number of columns”.</p>

<p>For that matter we need to use other query that contain <code class="highlighter-rouge">UNION SELECT</code> with two another columns, we can achieve that goal with NULL, to doing so just type the following:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">select
  first_name,
  last_name
  FROM users WHERE user_id='1' or '0'='0'
  UNION
  SELECT NULL, database();</code></pre></figure>

<p>So, we can use sort of function query to extract more data about the database and it’s important that you new them all or most of them:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">SELECT NULL, database();
SELECT NULL, user();
SELECT NULL, version();</code></pre></figure>

<p><img src="/assets/images/sql-injection-026.png" alt="sql-injection-026.png" />
<strong>Figure 26</strong> Select null with function.</p>

<p>Now we know lets do some injection.
<img src="/assets/images/sql-injection-027.png" alt="sql-injection-027.png" />
<strong>Figure 27</strong> database() - for seen the database name.</p>

<p><img src="/assets/images/sql-injection-028.png" alt="sql-injection-028.png" />
<strong>Figure 28</strong> version() - for seen the version of our sql database.</p>

<p><img src="/assets/images/sql-injection-029.png" alt="sql-injection-029.png" />
<strong>Figure 29</strong> user() - for seen the user that used fro connection the sql server.</p>

<p>we will use in these commands a lot in this article, it is very important to know such information because let’s say in some mysql version you can do more stuff that in older version you can’t do, as example the command <code class="highlighter-rouge">ROW_NUMBER()</code> can be use in mysql version 8.0.2, but not in version 5.5. You can view in detail the <a href="https://dev.mysql.com/doc/mysqld-version-reference/en/mysqld-version-reference-opsfuncs.html">mysqld-version-reference.</a></p>

<p>Now let’s do the same with SELECT sentence that contain some query for password, the query I need to accomplish should look as follow:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SELECT first_name, last_name FROM users WHERE user_id = '1' union SELECT first_name, password FROM users WHERE user_id='1';
</code></pre></div></div>

<p>So the injection code look like that:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1' union SELECT first_name, password FROM users WHERE user_id='1
</code></pre></div></div>

<p><img src="/assets/images/sql-injection-020.png" alt="sql-injection-020.png" />
<strong>Figure 20</strong> Extract some password.</p>

<p>Well guys, did you saw that? the password is in the surname filed! it look like sort of hash so we need some tool that can find for us the real value of that hash. There is many hash crack out there, just for reminder, hash is some data that some cryptographic function was run on it and produces output of  160-bit value, please note that this is difference from encryption method, in hashing method you can’t extract the original data value from the hashing value because it is <a href="https://en.wikipedia.org/wiki/One-way_function">one-way function</a>, so the way to find some hashing of some value is to take some data and run the hash function on it and compare the output to the hashing value you wanted to, and if there is a match you now know what is the original value.</p>

<p>In our case I guess the hash value is md5 type so we can check in our linux machineand find a match, just type the command as follow:</p>

<figure class="highlight"><pre><code class="language-shell" data-lang="shell"><span class="nb">echo</span> <span class="nt">-n</span> password | md5sum</code></pre></figure>

<p><img src="/assets/images/sql-injection-021.png" alt="sql-injection-021.png" />
<strong>Figure 21</strong> Hash value.</p>

<p>Now if you compare the output to the hash value we already have from our database, this is the same value! which mean that the password is actually “password”. If you want to use some online database of crack hashing you can used this links:
<a href="https://crackstation.net/">crackstation</a>
<a href="https://hashkiller.co.uk/md5-decrypter.aspx">hashkiller</a>
<a href="https://www.onlinehashcrack.com/">onlinehashcrack</a>
I am using them a lot and they very helpful.</p>

<p>So, from that output we know that admin password is ‘password’… so typical lol :P</p>

<p>let’s try to extract other password from the database, just inject the follow:</p>

<figure class="highlight"><pre><code class="language-mysql" data-lang="mysql">1' union SELECT first_name, password FROM users WHERE user_id='1' or '0'='0</code></pre></figure>

<p>And that is it, all we need now is find out what is the real value for that hashs.</p>

<p><img src="/assets/images/sql-injection-022.png" alt="sql-injection-022.png" />
<strong>Figure 22</strong> Hashs passwords.</p>

<p>Let’s crack all password with john the ripper, just take the data and past it in some text editor with the following structure:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usename:hachPassword
</code></pre></div></div>

<p>I saved the data in text.txt file, then type the following command in your terminal:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>john --format=raw-MD5 text.txt
</code></pre></div></div>

<p><img src="/assets/images/sql-injection-023.png" alt="sql-injection-023.png" />
<strong>Figure 23</strong> john the ripper.</p>

<p>Please note that so far we used Union base to find the data we needed, we will implement more injection types in this article, just bear with me for a moment.</p>

<p>Now let’s go to the higher level,</p>

<h3 id="how-to-migrate-that-vulnerability">How to migrate that vulnerability.</h3>
<p><strong>coming soon</strong></p>

    



<div class="post-tags">
  
    
    <a href="/tags.html#injection">
    
      <span class="icon">
        <svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
    <path d="M0 0h24v24H0z" fill="none"/>
    <path d="M17.63 5.84C17.27 5.33 16.67 5 16 5L5 5.01C3.9 5.01 3 5.9 3 7v10c0 1.1.9 1.99 2 1.99L16 19c.67 0 1.27-.33 1.63-.84L22 12l-4.37-6.16z"/>
</svg>
      </span>&nbsp;<span class="tag-name">Injection</span>
    </a>
  
</div>
  </div>

  
  <section class="comments">
    <h2>Comments</h2>
    
  <div id="disqus_thread">
    <button class="disqus-load" onClick="loadDisqusComments()">
      Load Comments
    </button>
  </div>
  <script>

  /**
  *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
  *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
  *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
  *  https://disqus.com/admin/universalcode/#configuration-variables
  */
  var disqus_config = function () {
    this.page.url = "http://localhost:4000/2017/11/27/SQL-Injection.html";
    this.page.identifier = "" ||
                           "http://localhost:4000/2017/11/27/SQL-Injection.html";
  }
  function loadDisqusComments() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');
    s.src = 'https://zwerd-com.disqus.com/embed.js';
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  }
  </script>
  <noscript>
    Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript">comments powered by Disqus</a>.
  </noscript>


  </section>


  <section class="related">
  <h2>Related Posts</h2>
  <ul class="posts-list">
    
      <li>
        <h3>
          <a href="/2017/11/24/TCP-connection.html">
            TCP connection
            <small>24 Nov 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2017/10/23/Abiha-hidot.html">
            Nach Riddles!
            <small>23 Oct 2017</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2017/10/22/CheckPoint.html">
            CheckPoint
            <small>22 Oct 2017</small>
          </a>
        </h3>
      </li>
    
  </ul>
</section>

</div>

    </main>

    <!-- Optional footer content -->

  </body>
</html>
